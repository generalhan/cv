 ;----------------------------------------------------------------------------
 ;----------------------------------------------------------------------------
 ;----------------------------------------------------------------------------
 ;-----------------  3  -----------------------
 ;--------------------------- 2004 -21---------------------------------
 ;----------------------------------------------------------------------------
 ;----------------------------------------------------------------------------
 ;----------------------------------------------------------------------------
.MODEL SMALL
 ;------------------------------OKNO------------------------------------------
 OKNO STRUC
 X1 DW 0                   ;[DI]
 Y1 DW 0                   ;[DI+2] 
 X2 DW 0                   ;[DI+4]     
 Y2 DW 0                   ;[DI+6]
 COLOR DW 30               ;[DI+8]                            
 NUMBER DW 0               ;[DI+10]
 CURX DW 1                 ;[DI+12] -   X   
 CURY DW 1                 ;[DI+14] -   Y   
 BUF DW 0                  ;[DI+16] -   
 POLOGENEI_KURSORA DW 0    ;[DI+18] -    
 OPEN_OR_CLOSE_WINDOW DW 0 ;[DI+20]    
 OKNO ENDS
 ;----------------------------------------------------------------------------
.DATA
 ;----------------------------------------------------------------------------
 PUBLIC MAS1
 MAS1 OKNO 8 DUP (<>)               ; 8   -   OKNO
 ;----------------------------------------------------------------------------
 PUBLIC MAS
 MAS DW 8 DUP (0)                              ;   8 
 ;--------------------   ---------------------------------
 PUBLIC BUFER
 BUFER DB 5544 DUP (20H)                           ; 693    
 ;-----------------    -----------------------------
 PUBLIC CD      ; 
 CD DW 0                       
 PUBLIC ANTICD  ;  ,   
 ANTICD DW 0
 PUBLIC CD1
 CD1 DW 0
 PUBLIC CD2
 CD2 DW 0
 ;----------------------------------------------------------------------------
 PUBLIC XYMAS
 XYMAS DW 0                        ;    MAS-  MAS
 ;----------------------------------------------------------------------------
 PUBLIC R
 R DW 0                           ;     
 PUBLIC CX_1
 CX_1 DW 0                                               ;   X
 PUBLIC DX_1
 DX_1 DW 0                                               ;   Y
 ;----------------------------------------------------------------------------
 VIDEO DW 0                                ;   
 ;--------------------------- ----------------------------
 PUBLIC PAR1
 PAR1 DW 0
 PUBLIC PAR2
 PAR2 DW 0
 PUBLIC PAR3
 PAR3 DW 0
 PUBLIC PAR4
 PAR4 DW 0
 PUBLIC PAR5
 PAR5 DB 0
 PUBLIC PAR6
 PAR6 DW 0
 ;----------------------------------------------------------------------------
 PUBLIC RAM1
 RAM1 DW 0
 PUBLIC RAM2
 RAM2 DW 0
 PUBLIC RAM3
 RAM3 DW 0
 PUBLIC RAM4
 RAM4 DW 0
 ;------------------    ----------------------
 PUBLIC I
 I DW 0
 ;-------------    ---------------------------------
 P1X DW 0
 P2X DW 0
 P1Y DW 0
 P2Y DW 0
 ;-------- -         --------
 FLAG DW 0
 ;-----------   -    ---------------
 PUBLIC BUFQ
 BUFQ DW 0
 ;-------        --------------
 OPEN@ DB 'OPEN..............'
 ;-----------------ASCII-   ------------------
 PUBLIC TEC_AL
 TEC_AL DB 0                        
 PUBLIC TEC_AH
 TEC_AH DB 0                        
 ;-----------------     FILE--------------------------
 FLAG_FILE DB 0
 PUBLIC RW
 RW DB 120
 PUBLIC PW
 PW DB 127
 PUBLIC SW
 SW DW 18
 ;----------------------- ------------------------------------------
 FLAG_EXIT DB 0
 ;----------------------    --------------------------
 PUBLIC POLE_K
 POLE_K DW 0
 PUBLIC POLE_AH
 POLE_AH DB 0
 PUBLIC POLE_DI
 POLE_DI DW 0
 ;----------- ,      OPEN---------
 PUBLIC FLAG_OPEN
 FLAG_OPEN DB 0
 ;----------- ,      SAVE---------
 PUBLIC FLAG_SAVE
 FLAG_SAVE DB 0
 ;-------- ,      DELETE----------
 PUBLIC FLAG_DELETE
 FLAG_DELETE DB 0
 ;-----------------    ---------------------------------
 PUBLIC FLEG
 FLEG DW 0
 ;-----------------    ---------------------------------
 PUBLIC FLAGG
 FLAGG DW 0
 ;-------      -------------
 KOL_SIMBOLOV_STROKA_MAX EQU 63           
 ;----------------------------------------------------------------------------
 ;-----------------     DELETE ------------
 ;----------------------------------------------------------------------------
 PUBLIC FLAG_DELETE_OK
 FLAG_DELETE_OK DB 0
 PUBLIC FLAG_DELETE_ESC
 FLAG_DELETE_ESC DB 0
 ;----------------------------------------------------------------------------
 PUBLIC RI_TEC
 RI_TEC DW 0 
 PUBLIC BUFER_DELETE
 BUFER_DELETE DB 41 DUP (0)
 ;----------------------------------------------------------------------------
 ;-----------------     OPEN --------------
 ;----------------------------------------------------------------------------
 PUBLIC FLAG_OPEN_OK
 FLAG_OPEN_OK DB 0
 PUBLIC FLAG_OPEN_ESC
 FLAG_OPEN_ESC DB 0
 ;----------------------------------------------------------------------------
 PUBLIC OI_TEC                               ;    
 OI_TEC DW 0 
 PUBLIC BUFER_OPEN
 BUFER_OPEN DB 43 DUP (0)        ;     OPEN
 ;----------------------------------------------------------------------------
 ;-----------------     SAVE --------------
 ;----------------------------------------------------------------------------
 PUBLIC FLAG_SAVE_OK
 FLAG_SAVE_OK DB 0
 PUBLIC FLAG_SAVE_ESC
 FLAG_SAVE_ESC DB 0
 ;----------------------------------------------------------------------------
 PUBLIC SI_TEC
 SI_TEC DW 0
 PUBLIC BUFER_SAVE
 BUFER_SAVE DB 43 DUP (0)
 PUBLIC BUFER_SIMBOL_SAVE
 BUFER_SIMBOL_SAVE DB 693 DUP (20H)
 ;----------------------------------------------------------------------------
 ;---  -    (   . )-----
 ;----------------------------------------------------------------------------
 CHISLO_BYTE_EQU EQU 693
 PUBLIC CHISLO_BYTE
 CHISLO_BYTE DW 0                       ;     - 639
 ;---------     ------------------------------
 PUBLIC KAX
 KAX DW 0
 PUBLIC PRED_AL
 PRED_AL DB 0
 ;------------------------  ------------------------------
 BX_TEC DW 0 
.386
.STACK 100H
.CODE
 ;------------------------ -----------------------------------
 EXTRN FILE_POLE:NEAR
 EXTRN POLE:NEAR
 EXTRN NASTROIKA_MOUSE:NEAR
 EXTRN RAMA:NEAR
 EXTRN WINDOW:NEAR
 EXTRN WINDOW_ZAGOLOBOK:NEAR
 EXTRN FILE:NEAR
 EXTRN WHO_PROC:NEAR
 EXTRN FILE_PROC:NEAR
 EXTRN WINDOW_STIR:NEAR
 EXTRN PROCEDURE_MAS:NEAR
 EXTRN CLICK_MOUSE_FLAG_TRUE:NEAR
 EXTRN ACTIV_POLE:NEAR
 EXTRN STIR_FILE:NEAR
 EXTRN TUTOR:NEAR
 EXTRN USER:NEAR
 EXTRN PROBERKA_ZAKRITIE:NEAR
 EXTRN OTOBRAGENIE_ACTIV_WINDOW:NEAR
 EXTRN USER_ACTIV_WINDOW:NEAR
 EXTRN NEW_WINDOW:NEAR
 EXTRN RISOBANIE_NEW_WINDOW:NEAR 
 EXTRN TEXT:NEAR
 EXTRN BBOD_WINDOW_SAVE:NEAR
 EXTRN BBOD_WINDOW_DELETE:NEAR
 EXTRN DELETE_WINDOW:NEAR
 EXTRN SAVE_WINDOW:NEAR
 EXTRN OPEN_WINDOW:NEAR
 EXTRN PROBERKA_BCE_OKNA_CLOSE:NEAR
 EXTRN BBOD_WINDOW_OPEN:NEAR
 EXTRN BBOD_WINDOW_USER:NEAR
 EXTRN PROCEDURE_CURSOR:NEAR
;-----------------------------------------------------------------------------
;
;
;                                 
;
;
;                               
;
;
;
;
;
;
;-----------------------------------------------------------------------------
MAIN:
     MOV AX,@DATA
     MOV DS,AX
     MOV AH,4FH
     MOV AL,03
     INT 10h
     MOV VIDEO,BX
     MOV AH,00h
     MOV AL,02h
     INT 10h
     MOV AX,0B800h
     MOV ES,AX
;-----------------------------------------------------------------------------
;-------------------------- --------------------------------------
;-----------------------------------------------------------------------------
CALL DELETE_KURSOR
;-----------------------------------------------------------------------------
;------------------------- --------------------------------------
;-----------------------------------------------------------------------------
CALL NASTROIKA_MOUSE
MOV AX,@DATA
MOV DS,AX
XOR SI,SI
;-----------------------------------------------------------------------------
;---------------    ---------------------------
;-----------------------------------------------------------------------------
MOV PAR1,1
MOV PAR2,1
MOV PAR3,1
MOV PAR4,80
MOV PAR5,120
CALL WINDOW_ZAGOLOBOK
CALL WHO_PROC
CALL FILE_PROC
;-----------------------------------------------------------------------------
;------------------------  ------------------------------
;-----------------------------------------------------------------------------
MOV RAM1,160
MOV RAM2,78
MOV RAM3,22     
CALL RAMA
;-----------------------------------------------------------------------------
;-------------------  --------------------------------------
;-----------------------------------------------------------------------------
MOV PAR1,3
MOV PAR2,24
MOV PAR3,2
MOV PAR4,79
MOV PAR5,0
CALL WINDOW_ZAGOLOBOK
;-------------------------- ,   -----------------
MOV AX,CHISLO_BYTE_EQU
MOV CHISLO_BYTE,AX
;-----------------------------------------------------------------------------
;--------------------------   ----------------------
;-----------------------------------------------------------------------------
BESKONECHN_BBOD: 
                CMP ANTICD,1
                JL NR
                ;-------------------------------------------------------------
                CMP FLAG_SAVE,1
                JE NR
                ;-------------------------------------------------------------
                CMP FLAG_OPEN,1
                JE NR
                ;-------------------------------------------------------------
                CMP FLAG_DELETE,1
                JE NR
                ;-------------------------------------------------------------
                CMP FLAG_FILE,1
                JE NR
                ;---------------,  -------------------------
                CALL PROCEDURE_CURSOR
                NR:
                ;------------,   ---------------------
                MOV AX,0B00H
                INT 21h
                CMP AL,0
                JE NET_KLABA
                ;------------ -   ---------------
                MOV AX,@DATA                                                              
                MOV DS,AX
                MOV AX,0B800h
                MOV ES,AX
                ;-----   ,  ---------------------
                MOV AX,0
                INT 16H
                MOV TEC_AL,AL
                MOV TEC_AH,AH
                ;----------------CTRL-M  CTRL-[------------------------------
                CMP AX,320DH
                JE BESKONECHN_BBOD
                CMP AX,1A1BH
                JE BESKONECHN_BBOD
                ;------------------------------------------------------
                CMP AH,72
                JE ENTER_ 
                CMP AH,75
                JE ENTER_ 
                CMP AH,77
                JE ENTER_ 
                CMP AH,80
                JE ENTER_ 
                ;-------------------------------------------------------------
                CMP AL,20H
                JE ENTER_                                   ; 
                CMP AL,13
                JE ENTER_                                   ; 
                CMP AL,27
                JE ENTER_                                   ; 
                CMP AL,8
                JE ENTER_                                   ; 
                ;--------------  ---------------
                CMP AL,32
                JLE BESKONECHN_BBOD
                CMP AH,3BH
                JGE BESKONECHN_BBOD
                ;-------------------------------------------------------------
                ;-------------------------------------------------------------
                ;-------------------------------------------------------------
                ;-------------------------------------------------------------
                ;-------------------------------------------------------------
                ;-------------------------------------------------------------
                ;----------  ,   ---------------
                ;-------------------------------------------------------------
                ;-------------------------------------------------------------
                ;-------------------------------------------------------------
                ;-------------------------------------------------------------
                ;-------------------------------------------------------------
                ;-------------------------------------------------------------
                ENTER_:
                CMP FLAG_FILE,1
                JE NET_KLABA
                ;-------------------------------------------------------------
                ;-----------------,  FILE ----------------------
                ;-------------------------------------------------------------
                CMP FLAG_SAVE,1
                JNE NET_FLAG_SAVE
                ;-------------------------------------------------------------
                ;------------------,    SAVE---------------------
                ;-------------------------------------------------------------
                CALL BBOD_WINDOW_SAVE
                JMP NET_KLABA
                NET_FLAG_SAVE:
                ;-------------------------------------------------------------
                ;-----------------,  FILE ----------------------
                ;-------------------------------------------------------------
                CMP FLAG_DELETE,1
                JNE NET_FLAG_DELETE
                ;-------------------------------------------------------------
                ;------------------,    DELETE-------------------
                ;-------------------------------------------------------------
                CALL BBOD_WINDOW_DELETE
                JMP NET_KLABA
                NET_FLAG_DELETE:
                ;-------------------------------------------------------------
                ;-----------------,  FILE ----------------------
                ;-------------------------------------------------------------
                CMP FLAG_OPEN,1
                JNE NET_FLAG_OPEN
                ;-------------------------------------------------------------
                ;------------------,    OPEN---------------------
                ;-------------------------------------------------------------
                CALL BBOD_WINDOW_OPEN
                JMP NET_KLABA
                NET_FLAG_OPEN:
                ;-------------------------------------------------------------
                ;-------------------------------------------------------------
                ;-------------------------------------------------------------
                ;-------------------------------------------------------------
                ;-------------------------------------------------------------
                ;-------------------------------------------------------------
                ;-----    -   ------------------
                ;-------------------------------------------------------------
                ;-------------------------------------------------------------
                ;-------------------------------------------------------------
                ;-------------------------------------------------------------
                ;-------------------------------------------------------------
                ;-------------------------------------------------------------
                CALL PROCEDURE_MAS
                XOR AX,AX
                CMP [DI+20],AX
                JE NET_WINDOW_STOP
                CALL BBOD_WINDOW_USER
                NET_WINDOW_STOP:
                ;-------------------------------------------------------------
                ;-------------------------------------------------------------
                ;------------  ---------------------
                ;-------------------------------------------------------------
                ;-------------------------------------------------------------
                NET_KLABA:
                MOV AX,@CODE
                MOV ES,AX
                MOV AX,0CH
                MOV CX,11b
                LEA DX,HANDLER
                INT 33h              
                ;--------------  ,  -------------------
                CMP FLAG_EXIT,1
                JE EXIT
                NET_KLABA@:
JMP BESKONECHN_BBOD
;-----------------------------------------------------------------------------
EXIT:
    MOV AX,0ch
    MOV CX,0h
    INT 33h
    MOV BX,VIDEO
    XOR BH,BH
    MOV AH,00h
    MOV AX,BX
    INT 10H
    MOV AH,4CH
    INT 21H
;-----------------------------------------------------------------------------
;------------------   ---------------------------------
;-----------------------------------------------------------------------------
HANDLER:
        MOV AX,0B800h
        MOV ES,AX
        MOV AX,@DATA
        MOV DS,AX
        XOR SI,SI
        ;----------------------- ---------------------------------
        MOV AX,2
        INT 33h     
        ;-----------------  ---------------------------
        MOV AX,3
        INT 33h
        ;----------------- ----------------------------
        SHR CX,3
        SHR DX,3
        INC CX
        INC DX
        MOV BX_TEC,BX
        ;---------------------------------------------------------------------
        ;----------------   ----------------------------
        ;---------------------------------------------------------------------
        CMP FLAG_SAVE,1
        JE TRUE_SAVE
        ;---------------------------------------------------------------------
        CMP FLAG_OPEN,1
        JE TRUE_OPEN
        ;---------------------------------------------------------------------
        CMP FLAG_DELETE,1
        JE TRUE_DELETE
        ;-------------------   3  -------------------
        JMP ALL_WINDOW_MENU_BBOD_CLOSE
        ;---------------------------------------------------------------------
        ;---------------------------------------------------------------------
        ;---------------------   SAVE --------------------
        ;---------------------------------------------------------------------
        ;---------------------------------------------------------------------
        TRUE_SAVE:
                  CMP BX_TEC,1
                  JNE DRAIVER@  
        ;---------------------------------------------------------------------
        ;---------------      SAVE, --------------
        ;---------------------------------------------------------------------
        CMP CX,1DH
        JL DRAIVER
        CMP CX,1FH
        JGE DRAIVER
        CMP DX,0BH
        JL DRAIVER
        CMP DX,0BH
        JG DRAIVER
        ;--------------------  OK-----------------------------------
        MOV FLAG_SAVE_OK,1
        CALL BBOD_WINDOW_SAVE
        JMP NEAR:NET_MOUSE
        ;---------------------------------------------------------------------
        DRAIVER:
        CMP CX,33H
        JL DRAIVER@
        CMP CX,39H
        JGE DRAIVER@
        CMP DX,0BH
        JL DRAIVER@
        CMP DX,0BH
        JG DRAIVER@
        ;-------------------,     ESC--------------------
        MOV FLAG_SAVE_ESC,1
        CALL BBOD_WINDOW_SAVE
        JMP NEAR:NET_MOUSE
        ;---------------------------------------------------------------------
        DRAIVER@:
        JMP NEAR:EXIT_PROC                             ;   SAVE
        ;---------------------------------------------------------------------
        ;---------------------------------------------------------------------
        ;-------------------   DELETE --------------------
        ;---------------------------------------------------------------------
        ;---------------------------------------------------------------------
        TRUE_DELETE:
                  CMP BX_TEC,1
                  JNE DRAIVED@  
        ;---------------------------------------------------------------------
        ;---------------      DELETE, ------------
        ;---------------------------------------------------------------------
        CMP CX,1DH
        JL DRAIVED
        CMP CX,1FH
        JGE DRAIVED
        CMP DX,0BH
        JL DRAIVED
        CMP DX,0BH
        JG DRAIVED
        ;--------------------  OK-----------------------------------
        MOV FLAG_DELETE_OK,1
        CALL BBOD_WINDOW_DELETE
        JMP NEAR:EXIT_PROC
        ;---------------------------------------------------------------------
        DRAIVED:
        CMP CX,33H
        JL DRAIVED@
        CMP CX,39H
        JGE DRAIVED@
        CMP DX,0BH
        JL DRAIVED@
        CMP DX,0BH
        JG DRAIVED@
        ;-------------------,     ESC--------------------
        MOV FLAG_DELETE_ESC,1
        CALL BBOD_WINDOW_DELETE
        JMP NEAR:EXIT_PROC
        ;---------------------------------------------------------------------
        DRAIVED@:
        JMP NEAR:EXIT_PROC                           ;   DELETE
        ;---------------------------------------------------------------------
        ;---------------------------------------------------------------------
        ;-------------------   OPEN ----------------------
        ;---------------------------------------------------------------------
        ;---------------------------------------------------------------------
        TRUE_OPEN:
                  CMP BX_TEC,1
                  JNE DRAIVEO@  
        ;---------------------------------------------------------------------
        ;---------------      OPEN, --------------
        ;---------------------------------------------------------------------
        CMP CX,1DH
        JL DRAIVEO
        CMP CX,1FH
        JGE DRAIVEO
        CMP DX,0BH
        JL DRAIVEO
        CMP DX,0BH
        JG DRAIVEO
        ;--------------------  OK-----------------------------------
        MOV FLAG_OPEN_OK,1
        CALL BBOD_WINDOW_OPEN
        JMP NEAR:EXIT_PROC
        ;---------------------------------------------------------------------
        DRAIVEO:
        CMP CX,33H
        JL DRAIVEO@
        CMP CX,39H
        JGE DRAIVEO@
        CMP DX,0BH
        JL DRAIVEO@
        CMP DX,0BH
        JG DRAIVEO@
        ;-------------------,     ESC--------------------
        MOV FLAG_OPEN_ESC,1
        CALL BBOD_WINDOW_OPEN
        JMP NEAR:EXIT_PROC
        ;---------------------------------------------------------------------
        DRAIVEO@:
        JMP NEAR:EXIT_PROC                             ;   OPEN
        ;---------------------------------------------------------------------
        ;---------------------------------------------------------------------
        ;---------------------------------------------------------------------
        ;---------------------------------------------------------------------
        ;---------------------------------------------------------------------
        ;---------------------------------------------------------------------
        ;---------------    -----------------------
        ;---------------------------------------------------------------------
        ;---------------------------------------------------------------------
        ;---------------------------------------------------------------------
        ;---------------------------------------------------------------------
        ;---------------------------------------------------------------------
        ;---------------------------------------------------------------------
        ALL_WINDOW_MENU_BBOD_CLOSE:
        CMP BX_TEC,1
        JNE NET_MOUSE
        ;---------------------------------------------------------------------
        ;---------------------------------------------------------------------
        ;-----------------  FILE------------------------------------
        ;---------------------------------------------------------------------
        ;---------------------------------------------------------------------
        CMP CX,2
        JL NET_FILE
        CMP CX,5
        JG NET_FILE
        CMP DX,1
        JG NET_FILE
        ;-----------------------  -----------------------------
        CALL DELETE_KURSOR
        PUSH CX
        PUSH DX
        CALL FILE
        CALL FILE_POLE
        MOV AH,PW
        MOV POLE_AH,AH
        MOV POLE_DI,324
        LEA SI,OPEN@
        CALL POLE
        POP DX
        POP CX
        MOV FLAG_FILE,1
        JMP NET_MOUSE
        ;---------------------------------------------------------------------
        ;---------------------------------------------------------------------
        ;---------------------------------------------------------------------
        NET_FILE:
        CMP FLAG_FILE,1
        JNE NET_MOUSE     
        ;-------------------,  ----------------------------------
        CMP CX,2
        JL NET_FLAG_FILE@
        CMP CX,21
        JG NET_FLAG_FILE@
        CMP DX,2
        JL NET_FLAG_FILE@
        CMP DX,8
        JG NET_FLAG_FILE@
        ;---------------------------------------------------------------------
        ;---------------------------------------------------------------------
        ;---------------     ----------------
        ;---------------------- ---------------------------
        ;---------------------------------------------------------------------
        ;---------------------------------------------------------------------
        CMP CX,3                                                       
        JL NET_OPEN
        CMP CX,20
        JG NET_OPEN
        CMP DX,3                       
        JL NET_OPEN
        CMP DX,3
        JG NET_OPEN
        ;---------------------------------------------------------------------
        ;---------------------,   OPEN-----------------------------
        ;---------------------------------------------------------------------
        CMP ANTICD,8;CD-  , ANTICD-  .  .
        JGE NET_NEW_WINDOW
        MOV FLAG_FILE,0    ;  
        CALL DELETE_KURSOR
        CALL OPEN_WINDOW
        NET_NEW_WINDOW:
        JMP EXIT_PROC
        ;---------------------------------------------------------------------
        NET_OPEN:
        CMP CX,3
        JL NET_DELETE
        CMP CX,20
        JG NET_DELETE
        CMP DX,4                        
        JL NET_DELETE
        CMP DX,4
        JG NET_DELETE
        ;---------------------------------------------------------------------
        ;---------------------,   DELETE---------------------------
        ;---------------------------------------------------------------------
        CALL DELETE_KURSOR
        MOV FLAG_FILE,0
        CALL DELETE_WINDOW
        JMP EXIT_PROC 
        ;---------------------------------------------------------------------
        NET_DELETE:
        CMP CX,3
        JL NET_SAVE
        CMP CX,20
        JG NET_SAVE
        CMP DX,5                        
        JL NET_SAVE
        CMP DX,5
        JG NET_SAVE
        ;---------------------------------------------------------------------
        ;---------------------,   SAVE-----------------------------
        ;---------------------------------------------------------------------
        CMP ANTICD,1
        JL NET_CALL_SAVE_WINDOW       
        ;------------------      ---------------
        CALL DELETE_KURSOR
        MOV FLAG_FILE,0
        CALL SAVE_WINDOW
        NET_CALL_SAVE_WINDOW:JMP EXIT_PROC
        ;---------------------------------------------------------------------
        ;---------------------------------------------------------------------
        ;---------------------------------------------------------------------
        ;---------------------------------------------------------------------
        ;---------------------  EXIT---------------------------
        ;---------------------------------------------------------------------
        ;---------------------------------------------------------------------
        ;---------------------------------------------------------------------
        ;---------------------------------------------------------------------
        NET_SAVE:
        CMP CX,3
        JL NET_EXIT
        CMP CX,20
        JG NET_EXIT
        CMP DX,6                        
        JL NET_EXIT
        CMP DX,6
        JG NET_EXIT
        ;---------------------------------------------------------------------
        ;---------------------,   EXIT-----------------------------
        ;---------------------------------------------------------------------
        MOV FLAG_EXIT,1
        JMP EXIT_PROC  
        ;---------------------------------------------------------------------
        ;---------------------------------------------------------------------
        ;---------------------------------------------------------------------
        NET_EXIT:
        JMP NET_MOUSE  
        ;---------------------------------------------------------------------
        ;---------------------------------------------------------------------
        ;---------------------------------------------------------------------
        ;---------------------------------------------------------------------
        ;----------------     FILE---------------------
        ;---------------------------------------------------------------------
        ;---------------------------------------------------------------------
        ;---------------------------------------------------------------------
        ;---------------------------------------------------------------------
        NET_FLAG_FILE@:
                       CALL STIR_FILE                    ;  FILE
                       MOV FLAG_FILE,0   ; - FILE 
                       ;-------------- -------------------------
                       CMP CD,1
                       JL NET_PRORISOBKA_MENU_FILE
                       CALL USER
                       NET_PRORISOBKA_MENU_FILE:
        ;---------------------------------------------------------------------
        ;---------------------------------------------------------------------
        ;-----------------------  -----------------------------
        ;------------------------  FILE-----------------------------
        ;---------------------------------------------------------------------
        ;---------------------------------------------------------------------
        NET_MOUSE:
        ;------------------  ----------------------------------
        CMP FLAG_FILE,1
        JNE NET_ONE
        ;-----------,  -  -------------------
        CALL ACTIV_POLE
        JMP EXIT_PROC 
        ;---------------------------------------------------------------------
        ;---------------------------------------------------------------------
        ;------------------------  ------------------------------
        ;---------------------------------------------------------------------
        ;---------------------------------------------------------------------
        NET_ONE:
        CMP CD,1
        JL EXIT_PROC
        ;---------------------------------------------------------------------
        ;-----------      --------------
        ;-----------------   -----------------------------
        ;---------------------------------------------------------------------
        CMP BX_TEC,1
        JNE NET_FLAG
        ;------------------      ------------------
        CALL PROBERKA_BCE_OKNA_CLOSE
        CMP FLAGG,1
        JE EXIT_PROC
        ;-----------------   ---------------------------
        MOV AX,FLAG
        CMP AX,1
        ;-----------------  --------------------------------
        JNE FLAG_USTANOBKA        ; ,   
        ;---------------------------------------------------------------------
        ;-------------     --------------------
        ;---------------------------------------------------------------------
        CALL CLICK_MOUSE_FLAG_TRUE
        CALL USER                                        ;        
        JMP NET_NET_FLAG
        ;---------------------------------------------------------------------       
        ;----------------  ,    --------------
        ;---------------------------------------------------------------------
        FLAG_USTANOBKA:
                     ;------------  --------------------
                     CALL PROCEDURE_MAS
                     ;-----      -------
                     CMP CX,[DI]
                     JL NET_NET_FLAG                   
                     CMP CX,[DI+4]
                     JG NET_NET_FLAG                
                     CMP DX,[DI+2]
                     JL NET_NET_FLAG                            
                     CMP DX,[DI+2]
                     JG NET_NET_FLAG
                     ;--------------------------------------------------------
                     MOV AX,1
                     MOV FLAG,AX
                     MOV CX_1,CX
                     MOV DX_1,DX
                     JMP NET_NET_FLAG
       ;------------------    --------------------------
       NET_FLAG:XOR AX,AX
                MOV FLAG,0
       NET_NET_FLAG:
       ;----------------------------------------------------------------------
       ;----------------------------------------------------------------------
       ;---------------  ------------------------------
       ;----------------------------------------------------------------------
       ;----------------------------------------------------------------------
       CMP BX_TEC,1
       JNE EXIT_PROC
       ;----------------------------------------------------------------------
       ;-------------------   ---------------------------
       ;-----------------------  -------------------------
       ;----------------------------------------------------------------------
       CALL USER_ACTIV_WINDOW
       ;---------------,   ----------------------------
       CALL PROCEDURE_MAS
       MOV AX,2
       CMP [DI+20],AX
       JE NET_WINDOW_STOP@
       CALL TEXT
       NET_WINDOW_STOP@:
       ;----------------------------------------------------------------------
       EXIT_PROC:
                MOV AX,1
                INT 33h
RETF
;------------------------------ ------------------------------
DELETE_KURSOR PROC
              MOV AX,0200H
              XOR BX,BX
              MOV DX,9999H
              INT 10H
              RET
DELETE_KURSOR ENDP
;-----------------------------------------------------------------------------
END MAIN




                              


