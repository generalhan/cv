//////////////////////////////////////////////////////////////////////////////
//
//              Окончательная версия ЛР №1 по MFC
//              Автор: Потеренко А.Г. ВТ-31 2006г.
//              Дата завершения: 8.03.2006г.
//
//////////////////////////////////////////////////////////////////////////////
#include "afxwin.h" 
#include "resource.h" 
#include "Dialog_LAB1.h"
//////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////
class CFrameWnd_LAB1 : public CFrameWnd
{
   private:
     bool flag;
   public:
	CMenu Menu_LAB1;
	//////////////////////////////////////////////////////////////////////////
 	CFrameWnd_LAB1()
	{
        flag=false;
		Create(
			   NULL,
			   "Лабораторная работа №1",
			   WS_OVERLAPPEDWINDOW,
			   rectDefault,
		       NULL,
			   NULL
			  );
		Menu_LAB1.LoadMenu(IDR_MENU1);
        SetMenu(&Menu_LAB1);
	};
	//////////////////////////////////////////////////////////////////////////
	void LAB1_MENU_P1(HDC hdc,short int R, short int G,short int B)
	{
	  SetBkColor(hdc,GetSysColor(COLOR_3DDKSHADOW)); 
      char * S;
      S="Hello Windows NT!";
      for (int i=0;i<10;i++)
	  {
   	    SetTextColor(hdc,RGB(R-i*20,G-i*7,B+i)); 
        TextOut(hdc,10,10+20*i,S,lstrlen(S));
	  };
      S=NULL;
	}
	//////////////////////////////////////////////////////////////////////////
    void LAB1_MENU_FUNC1()
	{
		flag=true;       
		InvalidateRect(NULL,true);      
		UpdateWindow();
	};
	//////////////////////////////////////////////////////////////////////////
    void LAB1_MENU_FUNC2()
	{
	    CDialog_LAB1 D;
	    D.DoModal();	
	};
    //////////////////////////////////////////////////////////////////////////
	void LAB1_MENU_FUNC3()
	{
	  	DestroyWindow();
	};
	
	//////////////////////////////////////////////////////////////////////////
    void CFrameWnd_LAB1::OnPaint()
	{
       CPaintDC dc(this);
       CBrush brush(GetSysColor(COLOR_3DDKSHADOW));
       CRect REC;
       GetClientRect(REC);
       dc.FillRect(REC, &brush);	
       if (flag==true)
          LAB1_MENU_P1(dc,200,100,50);
	};
   private:
	DECLARE_MESSAGE_MAP();
};
//////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////
BEGIN_MESSAGE_MAP(CFrameWnd_LAB1, CFrameWnd)
    ON_WM_PAINT()
	ON_COMMAND(ID_MENUITEM40001,LAB1_MENU_FUNC2)
	ON_COMMAND(ID_MENUITEM40002,LAB1_MENU_FUNC1)
    ON_COMMAND(ID_MENUITEM40003,LAB1_MENU_FUNC3)
END_MESSAGE_MAP()
//////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////
class CWinApp_LAB1 : public CWinApp
{
  public:
	CWinApp_LAB1()
	{};
	virtual BOOL InitInstance()
	{
       	m_pMainWnd=new CFrameWnd_LAB1();	
	    ASSERT(m_pMainWnd);
 	    m_pMainWnd->ShowWindow(SW_SHOW);
	    m_pMainWnd->UpdateWindow();	
	    return TRUE;
	}
};
//////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////
CWinApp_LAB1 theApp;	
